{% load static %}
<section>
    <div class="container">
        <section class="row gy-5 py-4">
            <div class="col-12">
                <h3>Admin / Withdrawals</h3>
            </div>
        </section>

        <section class="row gy-5">
            <div class="col-6 col-md-3">
                <div class="shadow-sm summary rounded-3 p-3 text-center">
                    <i class="bi bi-briefcase-fill me-2"></i>
                    
                    <div class="pt-3"> 
                        <b>48</b>
                        <h5>Total Requests</h5>
                    </div>
                </div>
            </div>

            <div class="col-6 col-md-3">
                <div class="shadow-sm summary p-3 text-center">
                    <i class="bi bi-briefcase me-2"></i>
                    <div class="pt-3"> 
                        <b>48</b>
                        <h5>Pending Requests</h5>
                    </div>
                </div>
            </div>

            <div class="col-6 col-md-3">
                <div class="shadow-sm summary p-3 text-center">
                    <i class="bi bi-briefcase me-2"></i>
                    <div class="pt-3">
                        <b>$4,800</b> 
                        <h5>Approved</h5>
                    </div>
                </div>
            </div>

            <div class="col-6 col-md-3">
                <div class="shadow-sm summary p-3 text-center">
                    <i class="bi bi-briefcase me-2"></i>
                    <div class="pt-3"> 
                        <b>$41, 700</b>
                        <h5>Pending Amount</h5>
                    </div>
                </div>
            </div>
        </section>

        <section class="row gy-5 py-4">
            <article class="col-12 ms-auto pb-3 pt-4">
                <form class="mb-3 row" method="get">
                    <div class="col-12 col-sm-9">
                        <input type="hidden" name="tab" value="{{ active_tab }}"> <!-- Retain active tab -->
                        <input 
                            type="text" 
                            class="form-control form-control-lg" 
                            name="q" placeholder="Search by username or ID" 
                            value="{{ search_query }}"
                        >
                    </div>
                    <button type="submit" class="btn btn-primary col-12 col-sm-3">Search</button>
                </form>
            </article>

            <article class="col-12 mx-auto">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a 
                            class="nav-link {% if active_tab == 'all' %}active{% endif %}" 
                            href="?tab=all"
                        >
                            All Withdrawals
                        </a>
                    </li>
                    <li class="nav-item">
                        <a 
                            class="nav-link {% if active_tab == 'pending' %}active{% endif %}" 
                            href="?tab=pending"
                        >
                            Pending
                        </a>
                    </li>
                    <li class="nav-item">
                        <a 
                            class="nav-link {% if active_tab == 'rejected' %}active{% endif %}" 
                            href="?tab=rejected"
                        >
                            Rejected
                        </a>
                    </li>
                    <li class="nav-item">
                        <a 
                            class="nav-link {% if active_tab == 'successful' %}active{% endif %}" 
                            href="?tab=successful"
                        >
                            Successful
                        </a>
                    </li>
                </ul>

                <div
                    class="
                        bg-white 
                        rounded-2 
                        shadow-sm
                        table-responsive
                        p-5
                    "
                >
                    <table 
                    class="
                        table
                        animate__animated
                        animate__fadeInUp
                        animate_slow
                    ">
                    <thead>
                        <tr>
                            <!-- <th scope="col">S.NO</th> -->
                            <th scope="col">UserName</th>
                            <th scope="col">Amount</th>
                            <th scope="col">Payment Option</th>
                            <th scope="col">Total Profit</th>
                            <th scope="col">Date Created</th>
                            <th scope="col">Updated At</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for withdrawal in withdrawals %}
                        <tr>
                            <!-- <td>   
                                {{forloop.counter}}
                            </td> -->
                            <td class="fw-bolder">
                                <a href="#">
                                    <b>{{withdrawal.user}}</b>
                                </a>                                   
                            </td>
                            <td>
                                ${{withdrawal.amount}}
                            </td>
                            <td>
                                <span>{{withdrawal.payment_option}}</span> <br/>
                                {% if withdrawal.status == "pending" %}
                                <span class="fw-bolder text-warning">Pending </span> 
                               {% elif withdrawal.status == "rejected"  %}
                                <span class="fw-bolder text-danger">Rejected</span> 
                                {% else %}
                                <span class="fw-bolder text-success">Approved</span> 
                               {% endif %}
                            </td>
                            <td>
                               <sup class="fw-bold text-success">$</sup> 
                               {{withdrawal.investment.total_profit}}
                            </td>

                            <td>
                                {{withdrawal.created_at}}
                            </td>

                            <td>
                               {{withdrawal.updated_at}}
                            </td>
                            <td class="d-flex flex-row">
                                <a href="#" data-bs-toggle="modal" 
                                    data-bs-target="#studentDetailsModal{{withdrawal.id}}" 
                                    class="btn btn-info btn-lg mb-2 mx-2" 
                                    data-toggle="tooltip" 
                                    data-placement="bottom" 
                                    title="Studebt Details"
                                >
                                    <i class="bi bi-info-circle text-dark"></i>
                                </a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <h4 class="alert alert-info">No withdrawals</h4>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                </div>
            </article>
        </section>
    </div>
</section>